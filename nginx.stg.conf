server {
  listen 80;
  server_name _;

  # 정적 루트/인덱스 명시
  root  /usr/share/nginx/html;
  index index.html;

  # 해시된 정적 자원은 강캐시
  location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico|woff2?)$ {
    add_header Cache-Control "public, max-age=31536000, immutable";
    try_files $uri =404;
  }

  # SPA 라우팅: 실제 파일/폴더 없으면 index.html
  location / {
    try_files $uri $uri/ /index.html;
  }

  # (중요) 에러페이지로 index.html을 지정하지 마세요. 루프 위험
  # error_page 404 /index.html;  # ← 사용하지 않음

  # (선택) gzip
  gzip on;
  gzip_types text/plain text/css application/json application/javascript application/octet-stream image/svg+xml;
  gzip_min_length 1024;
}